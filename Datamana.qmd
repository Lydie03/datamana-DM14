---
title: "Data Management Project"
author : Lou Dhiver and Lydie Lazure 
output: pdf_document
---

# Phase 2 of the project

### Github project :

https://github.com/Lydie03/datamana-DM14

### Sources for data sets :

-   World Health Organization (WHO): Ambient air pollution attributable death rate (per 100,000 population, age-standardized) : https://www.who.int/data/gho/data/indicators/indicator-details/GHO/ambient-air-pollution-attributable-death-rate-(per-100-000-population-age-standardized)
-   World Health Organization (WHO): Ambient air pollution attributable DALYs (per 100,000 population, age-standardized) : https://www.who.int/data/gho/data/indicators/indicator-details/GHO/ambient-air-pollution-attributable-dalys-(per-100-000-population-age-standardized)
-   World Bank : GDP per capita (current US\$): https://data.worldbank.org/indicator/NY.GDP.PCAP.CD
-   World Health Organization (WHO): Ambient air pollution, Concentrations of fine particulate matter (PM2.5) per country : https://apps.who.int/gho/data/view.main.SDGPM25116v

#### World Health Organization (WHO) :

The World Health Organization (WHO) was created in 1948 and is responsible for public health on an international level.
In particular, the organization provides health related data across the world.

Through its Global Health Observatory (GHO), WHO offers an extensive repository of data on key health indicators, including life expectancy, maternal and child health, disease prevalence, vaccination coverage, and environmental factors like air and water quality.

These will allow us to assess the accuracy of the Kuznets curve, in particular in terms of health and sustainability.

#### World Bank :

The institution was created in 1945.
It is an international financing institution that loans to developing countries, with the aim to provide economic development support.

The World Bank provides a wide range of data for us to use.
It covers over 200 countries with indicators such as GDP, education, gender inequality or infrastructure.

## Presentation of the project

We have decided to test the environmental Kuznet's curve theory.
The idea is that a country will pollute a lot for a while in order to develop, and then reach a sufficient level of economic development to decrease its carbon dioxyde emissions.
We would then get an inverted u shaped line in the plan (GDP per capita, pollution).

We wish to verify the empirical accuracy of this theory, both by region and time periods.
Does it apply to different economic structures ?
Does it apply at any time over the years ?

We will then consider the subject from a more human perspective.
Pollution and its cost to a population's health : does it impact GDP ?
And if so, can we quantify it ?

## Loading the datasets

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(tidyr)
library(vroom)

DALYs <- vroom::vroom("DALYs.csv")
death_air_pollution <- vroom::vroom("death-air-pollution.csv")
SDG <- vroom::vroom("SDG indicators.csv")
GDP_per_capita <- vroom::vroom("API_NY.GDP.PCAP.CD_DS2_en_csv_v2_76.csv", skip=4, delim=",", col_names=TRUE)

```

## Data cleaning

### GDP per capita

By trying to get the column names of this dataset, we observed that it did not load properly.
There were the first four row of the Excel sheet presenting the data, hence compromising the understanding of the separator ",".
We removed the first four rows that did not contain any data and got a proper dataset to work with.

Also, the columns are too numerous and do not appear correctly (they end at 2005 instead of 2023).
We consequently suppress all columns for values previous to 2005 so we can match dates considered in out other datasets.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(readr)
library(dplyr)
data <- read_delim("API_NY.GDP.PCAP.CD_DS2_en_csv_v2_76.csv", delim = ",", skip = 4, col_names = TRUE)

GDP_clean <- data %>% select(1, (54:64))
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library (dplyr)
GDP_clean <- GDP_clean %>%
  rename (
    Country = "Country Name"
  )
```

### DALYs

This dataset is hard to work with in the sense that the columns have non explicit names.
Hence the following changes.
Dim1 becomes Sex, and FactValueNumericHigh (Low) beacome Mean_Value, Lowest_Value, Highest_Value.
To align with the rest of our data, Location becomes Country.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)

DALYs <- DALYs %>%
  rename(
    Mean_Value = "FactValueNumeric", 
    lowest_value = "FactValueNumericLow", 
    highest_value = "FactValueNumericHigh", 
    Sex = "Dim1", 
    Country = "Location"
  )


colnames(DALYs)
```

### Death air pollution and SDG

The observations are the same as for DALYs, hence the following changes.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
SDG <- SDG %>%
   rename(
     Mean_Value = "FactValueNumeric",
     lowest_value = "FactValueNumericLow",
     highest_value = "FactValueNumericHigh",
     Sex = "Dim1",
     Country = "Location"
   )
# we save a new base to have regular name for the columns 

## library(dplyr)
## write.csv(SDG, "SDG_modified.csv", row.names = FALSE)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
death_air_pollution <- death_air_pollution %>%
  rename(
    Mean_Value = "FactValueNumeric",
    lowest_value = "FactValueNumericLow",
    highest_value = "FactValueNumericHigh",
    Sex = "Dim1",
    Country = "Location"
  )
# we save a new base to have regular name for the columns 
## write.csv(death_air_pollution, "death_air_pollution_modified.csv", row.names = FALSE)
```

## Data description

To answer our research question, we will need data around pollution, GDP per capita and health.
To this end, we will be working with databases from the World Health Organization, and the World Bank.

References are listed in the appendix.

### DALYs

This aggregated indicator is extracted from the World Health Organization database.
It is described as follows : "DALYs for a disease or health condition are the sum of the years of life lost to due to premature mortality (YLLs) and the years lived with a disability (YLDs) due to prevalent cases of the disease or health condition in a population".
We will mostly use the variable cross countries, classified into regions (Africa, Eastern Europe, Asia, North and South America), by sex (male/female), by year (2010 to 2019) and by cause of death (cancer, trachea etc.).
This will allow us to evaluate possible external factors, such as armed conflicts, that might have had an impact on specific regions during a specific year.

This dataset will then be compared to pollution to answer our final sub research question : can a country observe long term growth while polluting despite the negative externalities in terms of health ?

#### Data summary and representation

##### Data summary per year

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# Data summary per year
library(dplyr)

# So we know how many countries total
unique_countries <- unique(DALYs$Country)
countries <- length(unique_countries)

# Statistical tools calculation
mean <- DALYs %>%
  group_by(DALYs$Country) %>%
  summarise(mean_value = mean(Mean_Value, na.rm = TRUE))

median_value <- DALYs %>%
  group_by(DALYs$Country) %>%
  summarise(median_value = median(Mean_Value, na.rm = TRUE)) 
median_value

sd <- DALYs %>%
  group_by(DALYs$Country) %>%
  summarise(sd = median(Mean_Value, na.rm = TRUE)) 



summary_table <- data.frame(
  "Mean DALY" = mean,
  "Median DALY" = median_value,
  "Standard Deviation" = sd
)

# Print the table
print(summary_table)
```

It seems values are fairly constant over the nine years considered in our dataset.
It seems grouping by countries might be more relevant.

##### Data summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# Data summary per country
mean_DALYs <- DALYs %>%
  group_by(Country) %>%
  summarise(mean_value = mean(Mean_Value, na.rm = TRUE))

median_value <- DALYs %>%
  group_by(Country) %>%
  summarise(median_value = median(Mean_Value, na.rm = TRUE)) 
median_value

sd <- DALYs %>%
  group_by(Country) %>%
  summarise(sd = median(Mean_Value, na.rm = TRUE)) 

summary_table <- data.frame(
  "Mean DALY" = mean_DALYs,
  "Median DALY" = median_value,
  "Standard Deviation" = sd
)

# Print the table
print(summary_table)
```

This summary allow us to highlight major discrepancies between regions.
Arranged from highest to lowest DALYs mean, we get that the first countries with most years lost due to prematured deaths are Afghanistan, Tajikistan and Chad.
Last three are Finland, Australia and Iceland.
We can consequently draw the hypothesis that there might be a negative relationship between the number of DALYs and a country's GDP.

##### Data visual representations

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# Data graphical representations

library(ggplot2)

# Grouping mean over time per country
DALYs_unique <- DALYs %>%
  group_by(ParentLocation) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE))

# Graphical representation
ggplot(data = DALYs_unique, aes(x = ParentLocation, y = Mean_Value, fill = ParentLocation)) +
  geom_bar(stat = "identity", color = "black") + 
  labs(
    title = "Distribution of Mean DALYs by Parent Location",
    x = "Parent Location",
    y = "Mean DALYs (Disability-Adjusted Life Years)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_brewer(palette = "Set3") 
```

When we group the mean of DALYs values over time per country, we get a rather interesting picture of the situation cross regions.
It seems DALYs are prevalent in Africa, Eastern Mediterranean and South-East Asia.
This will allow us to define control groups and to consider levels of development compared to DALYs.

The data summary allows us to get a broad view of the indicator over the world and over the short period of time considered (9 years, from 2010 to 2019)

### Death air pollution

This data set will be used to complete DALYs.
It also comes from the World Health Organization and is organized with the same categories and classifications.
It will allow us to get a more precise analysis on the effect of carbone emissions on health.

#### Data summary and visual representation

##### Summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(knitr)

death_air_pollution_unique <- death_air_pollution %>%
  group_by(Country) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE)) %>%
  arrange(desc(Mean_Value))

median <- death_air_pollution %>%
  group_by(Country) %>%
  summarise(median = median(Mean_Value, na.rm = TRUE))

sd <- death_air_pollution %>%
  group_by(Country) %>%
  summarise(sd = sd(Mean_Value, na.rm = TRUE))

summary_table <- death_air_pollution_unique %>% 
  inner_join(median, by = "Country") %>%
  inner_join(sd, by = "Country") %>%
  arrange(Mean_Value)

# Print the table
kable(summary_table, caption = "Summary Statistics of Deaths Due to Pollution per Country")
```

Arranged by the number of deaths due to air pollution, we get first two countries are China, India and China and last three ones St Vincent, Samoa and St Lucia.

##### Visual representation

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

# Grouping mean over time per country
death_air_pollution_unique <- death_air_pollution %>%
  group_by(ParentLocation) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE))

# Graphical representation
ggplot(death_air_pollution_unique, aes(x = reorder(ParentLocation, Mean_Value), y = Mean_Value)) + 
  geom_bar(stat = "identity", fill = "skyblue") + 
  theme_minimal() + 
  labs(title = "Mean Value of Deaths Due to Air Pollution by Parent Location", x = "Parent Location", y = "Mean Value") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8), plot.title = element_text(size = 14, face = "bold"), axis.title.x = element_text(size = 12, face = "bold"), axis.title.y = element_text(size = 12, face = "bold"))
```

Here it seems deaths due to air pollution is prevalent in South East Asia and Western Pacific.

### SDG

This dataset includes the measurement of fine particulate matter, that is to say the concentration of toxic elements in the air.
Again, since the dataset comes from the World Health organization, the classification remains the same.
It will allow us to get a cross country analysis, from 2010 to 2019.
We will compare the degree to which some regions are polluted and their GDP over the year.

#### Summary and visual representation of the data

##### Summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)

mean_SDG <- SDG %>%
  group_by(Country) %>%
  summarise(mean_value = mean(Mean_Value, na.rm = TRUE)) %>%
  arrange(desc(mean_value))

median_SDG <- SDG %>%
  group_by(Country) %>%
  summarise(median_value = median(Mean_Value, na.rm = TRUE))

sd_SDG <- SDG %>%
  group_by(Country) %>%
  summarise(sd = sd(Mean_Value, na.rm = TRUE)) 

summary_table <- mean_SDG %>% 
  inner_join(median_SDG, by = "Country") %>%
  inner_join(sd_SDG, by = "Country") %>%
  arrange(desc(mean_SDG))

# Print the table
kable(summary_table, caption = "Summary Statistics of SDG")
```

It appears here that the countries showing most toxic concentration are Afghanistan, Tajikistan an Kuweit.
We get here a partially similar result as for the DALYs, hence a potential correlation to consider in our models.

##### Visual representation

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

# Grouping mean over time per country
SDG_unique <- SDG %>%
  group_by(ParentLocation) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE))

# Graphical representation
ggplot(data = SDG_unique, aes(x = ParentLocation, y = Mean_Value, fill = ParentLocation)) +
  geom_bar(stat = "identity", color = "black") + # Barres remplies
  labs(
    title = "Average Fine Particulate Matter by Country (2010-2019)",
    x = "Parent Location",
    y = "Average Fine Particulate Matter (µg/m³)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_brewer(palette = "Set3")
```

The pattern here is quite similar to DALYs.
SDG is prevalent in Africa, Eastern Mediterranean and South-East Asia.

### GDP per capita

GDP (Gross domestic product) is obtained with the following macroeconomics formula : `GDP=C+I+G+(X−M)` That is to say the aggregation of consumption (C), investments (I), government spending (G) and the commercial balance (exports minus imports).
GDP per capita is the previous aggregate divided by the population size.
This choice will allow us to correct for countries size bias.

GDP will be our wealth indicator in the simulation of the Kuznet's environmental curve.

#### Summary and visual representation of the data

##### Summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)
library(knitr)

mean_gdp <- GDP_clean %>%
  rowwise() %>% 
  mutate(Mean_GDP = mean(c_across(`2009`:`2019`), na.rm = TRUE)) %>% 
  ungroup() %>% 
  select(`Country`, Mean_GDP)

median_gdp <- GDP_clean %>% 
  rowwise() %>% 
  mutate(Median_GDP = median(c_across(`2009`:`2019`), na.rm = TRUE)) %>% 
  ungroup() %>% 
  select(`Country`, Median_GDP)

sd_gdp <- GDP_clean %>% 
  rowwise() %>% 
  mutate(sd_GDP = median(c_across(`2009`:`2019`), na.rm = TRUE)) %>% 
  ungroup() %>% 
  select(`Country`, sd_GDP)

summary_table <- mean_gdp %>% 
  inner_join(median_gdp, by = "Country") %>%
  inner_join(sd_gdp, by = "Country") %>%
  arrange(desc(Mean_GDP))

# Print the table
kable(summary_table, caption = "Summary Statistics of GDP per country - from 2009 to 2019")
```

##### Visual representation

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

## Filtering by region
rows_to_keep <- c(182, 216, 231, 232, 237, 241, 260)
GDP_per_capita_cleaned_filtered <- GDP_clean |> 
  slice(rows_to_keep)

## Calculating mean over the specified period for each region
mean_values <- rowMeans(GDP_per_capita_cleaned_filtered[, 2:12], na.rm = TRUE) 
GDP_per_capita_cleaned_filtered$Mean_5_to_50 <- mean_values 

## Creating a bar chart with ggplot2
library(ggplot2)
ggplot(data = GDP_per_capita_cleaned_filtered, aes(x = `Country`, y = Mean_5_to_50)) +
  geom_bar(stat = "identity", fill = "steelblue") + 
  labs(
    x = "Country Name", 
    y = "Average GDP per Capita (Columns 5-50)", 
    title = "Average GDP per Capita by Country"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1) 
  )
```

We chose to use the aggregations made by the world bank to get a broad view of GDP per capita across the world.
We can draw in that sense our first intuitions.
It seems regions of the world have a very unequal distribution of wealth, especially compared to the OECD countries.
Low incomes seem to match low revenue activities such as agriculture or textile industries, when the OECD countries match group services and technologies.
Hence supposedly a higher pollution rate induced by low income countries prevalent economical activities.If we refer to our previous graphical representations, we can note however that it is not the case for Africa : agriculture does not pollute as much as textile industries in The East and Pacific Asia.

*ZIP on Moodle*

## GDP and gas emission : Kuznets curve (EKC)

### A first model - global view on gas emissions and GDP

We first proceed to merging our data.
For a first global view on our data, we used the means over time (2009 to 2019) for GDP per capita and SDGs, grouped by country.
We will first make no distinction between countries and time to get a broad view and then precise our analysis.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)
<<<<<<< HEAD
## DALYs <- DALYs |> 
##   rename("Country" = "Country Name")

## mean_gdp <- mean_gdp |> 
##   rename("Country" = "Country Name")

## mean_DALYs <- mean_DALYs |> 
##   rename("Country" = "Country Name")

## death_air_pollution <- death_air_pollution |> 
##   rename("Country" = "Location")

## mean_SDG <- mean_SDG |> 
##   rename("Country" = "Country Name")
=======
#DALYs <- DALYs |> 
 # rename("Country" = "Country Name")

#mean_gdp <- mean_gdp |> 
  #rename("Country" = "Country Name")

#mean_DALYs <- mean_DALYs |> 
 # rename("Country" = "Country Name")

#death_air_pollution <- death_air_pollution |> 
 # rename("Country" = "Location")

#mean_SDG <- mean_SDG |> 
  #rename("Country" = "Country Name")
>>>>>>> a0eb91974e954cfc93ccdcf17f24f33195c802d3

Merged_data <-  DALYs %>%
   inner_join(mean_gdp, by = c("Country")) %>%
   inner_join(mean_DALYs, by = c("Country")) %>%
  inner_join(death_air_pollution, by = c("Country"))%>% 
  inner_join(mean_SDG, by = c("Country"))

Merged_data <- Merged_data %>% 
  rename(SDGs = `mean_value.x`) %>%
  rename (deaths_due_to_pollution = `Mean_Value.y`)

```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model <- lm(SDGs ~ Mean_GDP, data = Merged_data)
summary(model)
```

##### Analysis :

Interpretation of Coefficients The intercept has a value of 559.5, meaning that when GDP is zero, the predicted SDG score is 559.5.

The slope coefficient is -0.008020, indicating that for every 1-unit increase in GDP, the SDG score decreases by 0.008020.
This suggests a weak negative relationship between GDP and SDGs, implying that as a country becomes wealthier, it is less likely to meet the Sustainable Development Goals (SDGs).

Significance of Coefficients The t-value and p-value are both very low (\<2e-16), suggesting that the relationship between GDP and SDGs is statistically significant and unlikely to be due to random chance.

Model Fit While the relationship between GDP and SDGs is statistically significant, the effect size remains very small, as shown by the low R-squared value (0.05726).
This suggests that GDP alone is not a strong predictor of SDG performance, and other factors likely have a much greater influence.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

ggplot(Merged_data, aes(x = Mean_GDP, y = SDGs)) +
  geom_point(alpha=0.1) +  # Ajoute les points du nuage
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() + theme( plot.title = element_text(size = 14, face = "bold", hjust = 0.5), axis.title = element_text(size = 12, face = "bold"), legend.title = element_text(size = 10, face = "bold"), legend.position = "right" ) +
  labs(
    x = "GDP",
    y = "SDG",
    title ="Regression model (1) : SDG ~ GDP"
  ) +
  theme_minimal()
```

Our fitted line implies a quite straightforward relationship between GDP and gas emissions : the richer a country is, the less it will pollute.
However, this is not enough to answer our question : has pollution been necessary ?
In other terms, we do not have here yet our environmental Kuznets curve, since we captured a single mean over time for each country.
It allows us however to get a first global impression on the relationship GDP has with SDGs.

### Considering GDP as a function of SDGs and deaths due to air pollution

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model2 <- lm(Mean_GDP ~ deaths_due_to_pollution * SDGs, data = Merged_data)
summary(model2)
```

#### Analysis

##### Interpretation of Coefficients :

The intercept has a value of 16,780, meaning that when both deaths due to pollution and SDGs are zero, the predicted GDP is 16,780.
However, since these values cannot realistically be zero, the intercept has limited real-world interpretability.

The slope coefficient for deaths due to pollution is -0.02846, indicating that for every 1-unit increase in pollution-related deaths, GDP decreases by 0.02846.
This suggests a negative relationship between pollution-related mortality and economic performance, which is quite logical, as the death of one person leads to the loss of a potential workforce.

The slope coefficient for SDGs is -7.213, meaning that for every 1-unit increase in the SDG score, GDP decreases by 7.213.
This suggests that, within this model, higher SDG performance is associated with lower GDP levels.
This means that when a country is more respectful of the sustainable development goals, its GDP decrease.
The interpretation of this is that pollution is leading to more wealth.

The interaction term between deaths due to pollution and SDGs has a coefficient of 0.00001712, suggesting that as SDG scores increase, the negative impact of pollution-related deaths on GDP is slightly mitigated.
However, the effect size is very small.

##### Significance of Coefficients :

The t-values for all coefficients are large in magnitude, and the p-values are extremely low (\<2e-16), indicating that the relationships between GDP, pollution-related deaths, and SDGs are statistically significant and unlikely to be due to random chance.

##### Model Fit :

While the relationships between GDP, pollution-related deaths, and SDGs are statistically significant, the low R-squared value (0.05905) suggests that these variables explain only 5.9% of the variation in GDP.
This indicates that GDP is influenced by many other factors not included in this model.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

fitted_values <- fitted(model2)
residuals <- residuals(model2)

library(interactions)
interact_plot(model2, pred = deaths_due_to_pollution, modx = SDGs, plot.points = TRUE, interval = TRUE) + labs( title = "Interaction Effect of Pollution and SDGs on GDP", x = "Deaths Due to Pollution", y = "Mean GDP" ) + theme_minimal() + theme( plot.title = element_text(size = 14, face = "bold", hjust = 0.5), axis.title = element_text(size = 12, face = "bold"), legend.title = element_text(size = 10, face = "bold"), legend.position = "right" )
```

\*\* Proposition autre régression linéaire pour interpétation\*\*

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model3 <- lm(SDGs ~ deaths_due_to_pollution * Mean_GDP, data = Merged_data)
summary(model3)

model4 <- lm(Mean_GDP ~ deaths_due_to_pollution * SDGs, data = Merged_data)
summary(model4)
```

#### Analysis

##### Model 3

##### Interpretation of Coefficients

The intercept has an estimated value of 556.3, meaning that when both deaths due to pollution and GDP are zero, the predicted SDG score is 556.3.
However, as these variables cannot realistically be zero, this intercept does not have a direct real-world interpretation.

The coefficient for the deaths due to pollution is 0.001295, indicating that for every 1-unit increase in pollution-related deaths, the SDG score increases by 0.001295.
This suggests a positive relationship between pollution-related mortality and SDG scores, which could reflect the presence of interventions or responses tied to public health measures that may impact SDG outcomes.

The coefficient for the mean of the GDP is -0.007771, meaning that for every 1-unit increase in GDP, the SDG score decreases by 0.007771.
This suggests a negative relationship between GDP and SDG performance, possibly reflecting the prioritization of economic growth over certain SDG objectives, particularly those related to sustainability or inequality.

The interaction term between deaths due to pollution and Mean GDP has a coefficient of -1.799e-07, suggesting that as GDP increases, the positive relationship between deaths due to pollution and SDGs slightly decreases.
This indicates a small mitigating effect of GDP on the relationship between pollution-related deaths and SDG performance.

##### Significance of Coefficients

All coefficients are statistically significant, as indicated by their extremely low p-values (\< 2e-16).
This means that the relationships between SDGs, deaths due to pollution, and GDP are unlikely to be due to random chance, and all terms are crucial in explaining SDG scores.

##### Model Fit

The R-squared value is 0.05911, indicating that only 5.91% of the variation in SDGs is explained by deaths due to pollution, GDP, and their interaction.
This suggests that the model does not capture most of the variation in SDG scores, and other factors not included in the model likely play a more significant role in determining SDG performance.

The F-statistic is 1.086e+05, with a p-value of \<2.2e-16, indicating that the overall model is statistically significant.
However, the relatively low R-squared suggests that while the model is significant, it may not explain much of the variation in SDGs.

##### Model 4

##### Interpretation of Coefficients

The intercept has an estimated value of 16,780, meaning that when both deaths due to pollution and SDGs are zero, the predicted Mean GDP is 16,780.
However, as these values cannot realistically be zero, this intercept has limited real-world interpretability.

The coefficient for the deaths due to pollution is -0.02846, indicating that for every 1-unit increase in pollution-related deaths, Mean GDP decreases by 0.02846.
This suggests a negative relationship between pollution-related mortality and economic performance, meaning that higher deaths due to pollution are associated with lower GDP.

The coefficient for SDGs is -7.213, meaning that for every 1-unit increase in SDG score, Mean GDP decreases by 7.213.
This suggests that, within this model, higher SDG performance is associated with lower GDP levels, though this could reflect underlying structural factors, such as the costs associated with achieving certain SDG targets.

The interaction term between deaths due to pollution and SDGs has a coefficient of 0.00001712, suggesting that as SDG scores increase, the negative impact of pollution-related deaths on GDP is slightly mitigated.
However, the effect size is very small, indicating that while the interaction has some effect, it does not substantially alter the relationship between pollution-related deaths and GDP.

##### Significance of Coefficients

The t-values for all coefficients are large in magnitude, and the p-values are extremely low (\<2e-16), indicating that the relationships between GDP, pollution-related deaths, and SDGs are statistically significant and unlikely to be due to random chance.

##### Model Fit

The R-squared value is 0.05905, meaning that these variables explain only 5.91% of the variation in Mean GDP. This indicates that other factors not included in this model likely have a much larger influence on GDP.

The F-statistic is 1.084e+05 with a p-value of \<2.2e-16, showing that the model as a whole is statistically significant.
However, the relatively low R-squared suggests that although the model is significant, it does not explain much of the variation in GDP.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

fitted_values <- fitted(model3)
residuals <- residuals(model3)

plot(model3)

library (interactions)

interact_plot(model3, pred = deaths_due_to_pollution, modx = Mean_GDP, plot.points = TRUE, interval = TRUE) + 
  labs( title = "Interaction Effect of Pollution and GDP on SDGs", x = "Deaths Due to Pollution", y = "SDGs" ) +
  theme_minimal() + theme( plot.title = element_text(size = 14, face = "bold", hjust = 0.5), axis.title = element_text(size = 12, face = "bold"), legend.title = element_text(size = 10, face = "bold"), legend.position = "right" )
```

#### Checking for multicolinearity
We will use the Variance Inflation Factor (VIP) to assess multicollinearity between deaths due to pollution and gas emissions. 
```{r}
library(car)
vif_values <- vif(model4)
vif_values
```
Contrary to what we could have expected, they do not seem much correlated, since our VIP values do not exceed 5. We might want to add that pollution is way greater than only gas emissions. It seems here adding others indicators might actually help have a better understanding of pollution as a whole. 

#### Explanatory power and tests
<<<<<<< HEAD
We perform a Fisher test to assess the explanatory power of the model. 

```{r}
anova_results <- anova(model4)
anova_results
=======

##### Fisher test

##### Chi-2

### Working on specific countries to correct from mean imprecisions

We will try now to get an environmental Kuznets curve for Burkina Faso, Mexico and Canada.
Those choices allow use to reporesent three UN categories of countries income (very low, medium, high).
We chose those three specific ones first with data availability, second randomly over our dataset corrected from countries with too much missing data.

#### The case of Burkina Faso

Let's draw a simple model GDP over gas emissions.
We will proceed to an additional data cleaning to consider GDP only over 2009 to 2019 to align with SDGs.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
Burkina_Faso_GDP <- GDP_clean %>% filter(`Country` == "Burkina Faso")
Burkina_Faso_GDP <- Burkina_Faso_GDP %>% select(-2)
Burkina_Faso_GDP <- Burkina_Faso_GDP %>% select(2:11)

new_row <- as.data.frame(t(colnames(Burkina_Faso_GDP))) 
colnames(new_row) <- colnames(Burkina_Faso_GDP)

Burkina_Faso_GDP <- rbind(new_row, Burkina_Faso_GDP)
colnames(Burkina_Faso_GDP) <- rep("", ncol(Burkina_Faso_GDP))

# wide_data <- Burkina_Faso_GDP %>% pivot_wider (names_from = `1`, values_from = `2`)

library(dplyr)
# colnames(Burkina_Faso_GDP) <- make.names(colnames(Burkina_Faso_GDP), unique = TRUE) # Burkina_Faso_GDP <- Burkina_Faso_GDP %>% 
#   mutate(RowName = c("Period", "GDP"))

Burkina_Faso_SDG <- SDG %>% filter(`Country` == "Burkina Faso")
Burkina_Faso_SDG <- Burkina_Faso_SDG %>% filter(Sex == "Total")
Burkina_Faso_SDG <- Burkina_Faso_SDG %>% select(Period, `Mean_Value`)
long_data <- Burkina_Faso_SDG %>% pivot_longer(cols = everything())
                                
>>>>>>> a0eb91974e954cfc93ccdcf17f24f33195c802d3
```
We obtain very low p-values and hence significant F values. Our model consequently has explanatory power. 

<<<<<<< HEAD
##### Chi-2
In order to get a more precised analysis of the explanatory variables independance, we then perform a chi-squared test. 
```{r}
contingency_table <- table(Merged_data$SDGs, Merged_data$deaths_due_to_pollution) 

chi2_results <- chisq.test(contingency_table)
chi2_results
```
Results show a p value lower than 0,05, hence allowing us to reject the null hypothesis. Deaths due to population seems to be independent from SDGs. 
=======
#### The case of Mexico

#### The case of Canada

#### Analysis

## Conclusion

## References

1.  Stern, D. I.
    (2004).
    *The Rise and Fall of the Environmental Kuznets Curve*.
    *World Development*, 32(8), 1419--1439.
    https://doi.org/10.1016/j.worlddev.2004.03.004

2.  Dinda, S.
    (2004).
    *Environmental Kuznets Curve Hypothesis: A Survey*.
    *Ecological Economics*, 49(4), 431--455.
    https://doi.org/10.1016/j.ecolecon.2004.02.011

3.  Stern, D. I.
    (2017).
    *The Environmental Kuznets Curve After 25 Years*.
    *Journal of Bioeconomics*, 19, 7--28.
    https://doi.org/10.1007/s10818-017-9243-1
>>>>>>> a0eb91974e954cfc93ccdcf17f24f33195c802d3

4.  Özcan, B., & Öztürk, I.
    (2019).
    *Environmental Kuznets Curve (EKC): A Manual*.
    Academic Press.

5.  Raworth, K.
    (2017).
    *Doughnut Economics: Seven Ways to Think Like a 21st-Century Economist*.
    Chelsea Green Publishing.

6.  Salin, M.
    (2020).
    La « courbe de Kuznets environnementale » et le « découplage » : deux concepts du débat sur la croissance verte.
    *Regards croisés sur l'économie*, 26(1), 145--152.
    https://doi.org/10.3917/rce.026.0145

7.  Martínez-Alier, J.
    (2002).
    *The Environmentalism of the Poor: A Study of Ecological Conflicts and Valuation*.
    Northampton, MA: Edward Elgar Publishing.

8.  Laurent, É.
    (2009).
    *Écologie et inégalités*.
    *Revue de l'OFCE*, 109, 33--57.

9.  Destek, M. A., Ulucak, R., & Dogan, E.
    (2018).
    *Analyzing the Environmental Kuznets Curve for the EU Countries: The Role of Ecological Footprint*.
    *Environmental Science and Pollution Research*, 25(29), 29387--29396.
