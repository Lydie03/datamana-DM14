---
title: "Data Management Project"
author : Lou Dhiver and Lydie Lazure 
output: html
---

# Phase 2 of the project

### Github project :

https://github.com/Lydie03/datamana-DM14

### Sources for data sets :

-   World Health Organization (WHO): Ambient air pollution attributable death rate (per 100,000 population, age-standardized) : https://www.who.int/data/gho/data/indicators/indicator-details/GHO/ambient-air-pollution-attributable-death-rate-(per-100-000-population-age-standardized)
-   World Health Organization (WHO): Ambient air pollution attributable DALYs (per 100,000 population, age-standardized) : https://www.who.int/data/gho/data/indicators/indicator-details/GHO/ambient-air-pollution-attributable-dalys-(per-100-000-population-age-standardized)
-   World Bank : GDP per capita (current US\$): https://data.worldbank.org/indicator/NY.GDP.PCAP.CD
-   World Health Organization (WHO): Ambient air pollution, Concentrations of fine particulate matter (PM2.5) per country : https://apps.who.int/gho/data/view.main.SDGPM25116v

#### World Health Organization (WHO) :

The World Health Organization (WHO) was created in 1948 and is responsible for public health on an international level.
In particular, the organization provides health related data across the world.

Through its Global Health Observatory (GHO), WHO offers an extensive repository of data on key health indicators, including life expectancy, maternal and child health, disease prevalence, vaccination coverage, and environmental factors like air and water quality.

These will allow us to assess the accuracy of the Kuznets curve, in particular in terms of health and sustainability.

#### World Bank :

The institution was created in 1945.
It is an international financing institution that loans to developing countries, with the aim to provide economic development support.

The World Bank provides a wide range of data for us to use.
It covers over 200 countries with indicators such as GDP, education, gender inequality or infrastructure.

## Presentation of the project

We have decided to test the environmental Kuznet's curve theory.
The idea is that a country will pollute a lot for a while in order to develop, and then reach a sufficient level of economic development to decrease its carbon dioxyde emissions.
We would then get an inverted u shaped line in the plan (GDP per capita, pollution).

We wish to verify the empirical accuracy of this theory, both by region and time periods.
Does it apply to different economic structures ?
Does it apply at any time over the years ?

We will then consider the subject from a more human perspective.
Pollution and its cost to a population's health : does it impact GDP ?
And if so, can we quantify it ?

## Loading the datasets

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(tidyr)
library(vroom)

DALYs <- vroom::vroom("DALYs.csv")
death_air_pollution <- vroom::vroom("death-air-pollution.csv")
SDG <- vroom::vroom("SDG indicators.csv")
GDP_per_capita <- vroom::vroom("API_NY.GDP.PCAP.CD_DS2_en_csv_v2_76.csv", skip=4, delim=",", col_names=TRUE)

```

## Data cleaning

### GDP per capita

By trying to get the column names of this dataset, we observed that it did not load properly.
There were the first four row of the Excel sheet presenting the data, hence compromising the understanding of the separator ",".
We removed the first four rows that did not contain any data and got a proper dataset to work with.

Also, the columns are too numerous and do not appear correctly (they end at 2005 instead of 2023).
We consequently suppress all columns for values previous to 2005 so we can match dates considered in out other datasets.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(readr)
library(dplyr)
data <- read_delim("API_NY.GDP.PCAP.CD_DS2_en_csv_v2_76.csv", delim = ",", skip = 4, col_names = TRUE)

GDP_clean <- data %>% select(1, (54:64))
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library (dplyr)
GDP_clean <- GDP_clean %>%
  rename (
    Country = "Country Name"
  )
```

### DALYs

This dataset is hard to work with in the sense that the columns have non explicit names.
Hence the following changes.
Dim1 becomes Sex, and FactValueNumericHigh (Low) beacome Mean_Value, Lowest_Value, Highest_Value.
To align with the rest of our data, Location becomes Country.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)

DALYs <- DALYs %>%
  rename(
    Mean_Value = "FactValueNumeric", 
    lowest_value = "FactValueNumericLow", 
    highest_value = "FactValueNumericHigh", 
    Sex = "Dim1", 
    Country = "Location"
  )


colnames(DALYs)
```

### Death air pollution and SDG

The observations are the same as for DALYs, hence the following changes.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
SDG <- SDG %>%
  rename(
    Mean_Value = "FactValueNumeric",
    lowest_value = "FactValueNumericLow",
    highest_value = "FactValueNumericHigh",
    Sex = "Dim1",
    Country = "Location"
  )
# we save a new base to have regular name for the columns 
library(dplyr)
write.csv(SDG, "SDG_modified.csv", row.names = FALSE)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
death_air_pollution <- death_air_pollution %>%
  rename(
    Mean_Value = "FactValueNumeric",
    lowest_value = "FactValueNumericLow",
    highest_value = "FactValueNumericHigh",
    Sex = "Dim1",
    Country = "Location"
  )
# we save a new base to have regular name for the columns 
write.csv(death_air_pollution, "death_air_pollution_modified.csv", row.names = FALSE)
```

## Data description

To answer our research question, we will need data around pollution, GDP per capita and health.
To this end, we will be working with databases from the World Health Organization, and the World Bank.

References are listed in the appendix.

### DALYs

This aggregated indicator is extracted from the World Health Organization database.
It is described as follows : "DALYs for a disease or health condition are the sum of the years of life lost to due to premature mortality (YLLs) and the years lived with a disability (YLDs) due to prevalent cases of the disease or health condition in a population".
We will mostly use the variable cross countries, classified into regions (Africa, Eastern Europe, Asia, North and South America), by sex (male/female), by year (2010 to 2019) and by cause of death (cancer, trachea etc.).
This will allow us to evaluate possible external factors, such as armed conflicts, that might have had an impact on specific regions during a specific year.

This dataset will then be compared to pollution to answer our final sub research question : can a country observe long term growth while polluting despite the negative externalities in terms of health ?

#### Data summary and representation

##### Data summary per year

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# Data summary per year
library(dplyr)

# So we know how many countries total
unique_countries <- unique(DALYs$Country)
countries <- length(unique_countries)

# Statistical tools calculation
mean <- DALYs %>%
  group_by(DALYs$Country) %>%
  summarise(mean_value = mean(Mean_Value, na.rm = TRUE))

median_value <- DALYs %>%
  group_by(DALYs$Country) %>%
  summarise(median_value = median(Mean_Value, na.rm = TRUE)) 
median_value

sd <- DALYs %>%
  group_by(DALYs$Country) %>%
  summarise(sd = median(Mean_Value, na.rm = TRUE)) 



summary_table <- data.frame(
  "Mean DALY" = mean,
  "Median DALY" = median_value,
  "Standard Deviation" = sd
)

# Print the table
print(summary_table)
```

It seems values are fairly constant over the nine years considered in our dataset.
It seems grouping by countries might be more relevant.

##### Data summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# Data summary per country
mean_DALYs <- DALYs %>%
  group_by(Country) %>%
  summarise(mean_value = mean(Mean_Value, na.rm = TRUE))

median_value <- DALYs %>%
  group_by(Country) %>%
  summarise(median_value = median(Mean_Value, na.rm = TRUE)) 
median_value

sd <- DALYs %>%
  group_by(Country) %>%
  summarise(sd = median(Mean_Value, na.rm = TRUE)) 

summary_table <- data.frame(
  "Mean DALY" = mean_DALYs,
  "Median DALY" = median_value,
  "Standard Deviation" = sd
)

# Print the table
print(summary_table)
```

This summary allow us to highlight major discrepancies between regions.
Arranged from highest to lowest DALYs mean, we get that the first countries with most years lost due to prematured deaths are Afghanistan, Tajikistan and Chad.
Last three are Finland, Australia and Iceland.
We can consequently draw the hypothesis that there might be a negative relationship between the number of DALYs and a country's GDP.

##### Data visual representations

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# Data graphical representations

library(ggplot2)

# Grouping mean over time per country
DALYs_unique <- DALYs %>%
  group_by(ParentLocation) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE))

# Graphical representation
ggplot(data = DALYs_unique, aes(x = ParentLocation, y = Mean_Value, fill = ParentLocation)) +
  geom_bar(stat = "identity", color = "black") + 
  labs(
    title = "Distribution of Mean DALYs by Parent Location",
    x = "Parent Location",
    y = "Mean DALYs (Disability-Adjusted Life Years)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_brewer(palette = "Set3") 
```

When we group the mean of DALYs values over time per country, we get a rather interesting picture of the situation cross regions.
It seems DALYs are prevalent in Africa, Eastern Mediterranean and South-East Asia.
This will allow us to define control groups and to consider levels of development compared to DALYs.

The data summary allows us to get a broad view of the indicator over the world and over the short period of time considered (9 years, from 2010 to 2019)

### Death air pollution

This data set will be used to complete DALYs.
It also comes from the World Health Organization and is organized with the same categories and classifications.
It will allow us to get a more precise analysis on the effect of carbone emissions on health.

#### Data summary and visual representation

##### Summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(knitr)

death_air_pollution_unique <- death_air_pollution %>%
  group_by(Country) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE)) %>%
  arrange(desc(Mean_Value))

median <- death_air_pollution %>%
  group_by(Country) %>%
  summarise(median = median(Mean_Value, na.rm = TRUE))

sd <- death_air_pollution %>%
  group_by(Country) %>%
  summarise(sd = sd(Mean_Value, na.rm = TRUE))

summary_table <- death_air_pollution_unique %>% 
  inner_join(median, by = "Country") %>%
  inner_join(sd, by = "Country") %>%
  arrange(Mean_Value)

# Print the table
kable(summary_table, caption = "Summary Statistics of Deaths Due to Pollution per Country")
```

Arranged by the number of deaths due to air pollution, we get first two countries are China, India and China and last three ones St Vincent, Samoa and St Lucia.

##### Visual representation

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

# Grouping mean over time per country
death_air_pollution_unique <- death_air_pollution %>%
  group_by(ParentLocation) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE))

# Graphical representation
ggplot(death_air_pollution_unique, aes(x = reorder(ParentLocation, Mean_Value), y = Mean_Value)) + 
  geom_bar(stat = "identity", fill = "skyblue") + 
  theme_minimal() + 
  labs(title = "Mean Value of Deaths Due to Air Pollution by Parent Location", x = "Parent Location", y = "Mean Value") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8), plot.title = element_text(size = 14, face = "bold"), axis.title.x = element_text(size = 12, face = "bold"), axis.title.y = element_text(size = 12, face = "bold"))
```

Here it seems deaths due to air pollution is prevalent in South East Asia and Western Pacific.

### SDG

This dataset includes the measurement of fine particulate matter, that is to say the concentration of toxic elements in the air.
Again, since the dataset comes from the World Health organization, the classification remains the same.
It will allow us to get a cross country analysis, from 2010 to 2019.
We will compare the degree to which some regions are polluted and their GDP over the year.

#### Summary and visual representation of the data

##### Summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)

mean_SDG <- SDG %>%
  group_by(Country) %>%
  summarise(mean_value = mean(Mean_Value, na.rm = TRUE)) %>%
  arrange(desc(mean_value))

median_SDG <- SDG %>%
  group_by(Country) %>%
  summarise(median_value = median(Mean_Value, na.rm = TRUE))

sd_SDG <- SDG %>%
  group_by(Country) %>%
  summarise(sd = sd(Mean_Value, na.rm = TRUE)) 

summary_table <- mean_SDG %>% 
  inner_join(median_SDG, by = "Country") %>%
  inner_join(sd_SDG, by = "Country") %>%
  arrange(desc(mean_SDG))

# Print the table
kable(summary_table, caption = "Summary Statistics of SDG")
```

It appears here that the countries showing most toxic concentration are Afghanistan, Tajikistan an Kuweit.
We get here a partially similar result as for the DALYs, hence a potential correlation to consider in our models.

##### Visual representation

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

# Grouping mean over time per country
SDG_unique <- SDG %>%
  group_by(ParentLocation) %>%
  summarise(Mean_Value = mean(Mean_Value, na.rm = TRUE))

# Graphical representation
ggplot(data = SDG_unique, aes(x = ParentLocation, y = Mean_Value, fill = ParentLocation)) +
  geom_bar(stat = "identity", color = "black") + # Barres remplies
  labs(
    title = "Average Fine Particulate Matter by Country (2010-2019)",
    x = "Parent Location",
    y = "Average Fine Particulate Matter (µg/m³)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_brewer(palette = "Set3")
```

The pattern here is quite similar to DALYs.
SDG is prevalent in Africa, Eastern Mediterranean and South-East Asia.

### GDP per capita

GDP (Gross domestic product) is obtained with the following macroeconomics formula : `GDP=C+I+G+(X−M)` That is to say the aggregation of consumption (C), investments (I), government spending (G) and the commercial balance (exports minus imports).
GDP per capita is the previous aggregate divided by the population size.
This choice will allow us to correct for countries size bias.

GDP will be our wealth indicator in the simulation of the Kuznet's environmental curve.

#### Summary and visual representation of the data

##### Summary per country

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)
library(knitr)

mean_gdp <- GDP_clean %>%
  rowwise() %>% 
  mutate(Mean_GDP = mean(c_across(`2009`:`2019`), na.rm = TRUE)) %>% 
  ungroup() %>% 
  select(`Country`, Mean_GDP)

median_gdp <- GDP_clean %>% 
  rowwise() %>% 
  mutate(Median_GDP = median(c_across(`2009`:`2019`), na.rm = TRUE)) %>% 
  ungroup() %>% 
  select(`Country`, Median_GDP)

sd_gdp <- GDP_clean %>% 
  rowwise() %>% 
  mutate(sd_GDP = median(c_across(`2009`:`2019`), na.rm = TRUE)) %>% 
  ungroup() %>% 
  select(`Country`, sd_GDP)

summary_table <- mean_gdp %>% 
  inner_join(median_gdp, by = "Country") %>%
  inner_join(sd_gdp, by = "Country") %>%
  arrange(desc(Mean_GDP))

# Print the table
kable(summary_table, caption = "Summary Statistics of GDP per country - from 2009 to 2019")
```

##### Visual representation

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

## Filtering by region
rows_to_keep <- c(182, 216, 231, 232, 237, 241, 260)
GDP_per_capita_cleaned_filtered <- GDP_clean |> 
  slice(rows_to_keep)

## Calculating mean over the specified period for each region
mean_values <- rowMeans(GDP_per_capita_cleaned_filtered[, 2:12], na.rm = TRUE) 
GDP_per_capita_cleaned_filtered$Mean_5_to_50 <- mean_values 

## Creating a bar chart with ggplot2
library(ggplot2)
ggplot(data = GDP_per_capita_cleaned_filtered, aes(x = `Country`, y = Mean_5_to_50)) +
  geom_bar(stat = "identity", fill = "steelblue") + 
  labs(
    x = "Country Name", 
    y = "Average GDP per Capita (Columns 5-50)", 
    title = "Average GDP per Capita by Country"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1) 
  )
```

We chose to use the aggregations made by the world bank to get a broad view of GDP per capita across the world.
We can draw in that sense our first intuitions.
It seems regions of the world have a very unequal distribution of wealth, especially compared to the OECD countries.
Low incomes seem to match low revenue activities such as agriculture or textile industries, when the OECD countries match group services and technologies.
Hence supposedly a higher pollution rate induced by low income countries prevalent economical activities.If we refer to our previous graphical representations, we can note however that it is not the case for Africa : agriculture does not pollute as much as textile industries in The East and Pacific Asia.

### The environmental Kuznets curve - Theoretically, what are we looking for ?

The Kuznets Environmental Curve (KEC) is a hypothesized relationship between environmental quality and economic development.
It's an extension of the original Kuznets Curve, which examines the relationship between income inequality and economic development.

The KEC suggests that environmental degradation initially increases with economic development, but after reaching a certain level of income, the trend reverses, and environmental quality improves.
The result is an inverted U-shaped curve, similar to the original Kuznets Curve.

We suggest here a simulation to get a visual representation of the theory.

```{r}
library(ggplot2)

x <- seq(-50, 50, by = 1) 
y <- -0.01 * x^2 + 25  
u_curve_data <- data.frame(Income_Inequality = x, Economic_Development = y) 

ggplot(u_curve_data, aes(x = Income_Inequality, y = Economic_Development)) + geom_line(color = "blue", size = 1) + labs(title = "Theoretical environmental Kuznets inverted U-shaped slope", x = "Economic development", y = "Pollution") + theme_minimal() 

```

## GDP and gas emission : Kuznets curve (EKC)

### A first global view on gas emissions and GDP (model 1)

We first proceed to merging our data.
For a first global view on our data, we used the means over time (2009 to 2019) for GDP per capita and SDGs, grouped by country.
We will first make no distinction between countries and time to get a broad view and then precise our analysis.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(dplyr)
#DALYs <- DALYs |> 
 # rename("Country" = "Country Name")

#mean_gdp <- mean_gdp |> 
  #rename("Country" = "Country Name")

#mean_DALYs <- mean_DALYs |> 
 # rename("Country" = "Country Name")

#death_air_pollution <- death_air_pollution |> 
 # rename("Country" = "Location")

#mean_SDG <- mean_SDG |> 
  #rename("Country" = "Country Name")

Merged_data <-  DALYs %>%
   inner_join(mean_gdp, by = c("Country")) %>%
   inner_join(mean_DALYs, by = c("Country")) %>%
  inner_join(death_air_pollution, by = c("Country"))%>% 
  inner_join(mean_SDG, by = c("Country"))

Merged_data <- Merged_data %>% 
  rename(SDGs = `Mean_Value.x`) %>%
  rename (deaths_due_to_pollution = `Mean_Value.y`)

```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model <- lm(Mean_GDP ~ SDGs  , data = Merged_data)
summary(model)
```

##### Analysis :

##### Interpretation of Coefficients :

The intercept has a value of 559.5, meaning that when GDP is zero, the predicted SDG score is 559.5.

The slope coefficient is -0.008020, indicating that for every 1-unit increase in GDP, the SDG score decreases by 0.008020.
This suggests a weak negative relationship between GDP and SDGs, implying that as a country becomes wealthier, it is less likely to meet the Sustainable Development Goals (SDGs).

##### Significance of Coefficients :

The t-value and p-value are both very low (\<2e-16), suggesting that the relationship between GDP and SDGs is statistically significant and unlikely to be due to random chance.

##### Model Fit :

While the relationship between GDP and SDGs is statistically significant, the effect size remains very small, as shown by the low R-squared value (0.05726).
This suggests that GDP alone is not a strong predictor of SDG performance, and other factors likely have a much greater influence.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

ggplot(Merged_data, aes(x = SDGs, y = Mean_GDP)) +
  geom_point(alpha=0.1) +  # Ajoute les points du nuage
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() + theme( plot.title = element_text(size = 14, face = "bold", hjust = 0.5), axis.title = element_text(size = 12, face = "bold"), legend.title = element_text(size = 10, face = "bold"), legend.position = "right" ) +
  labs(
    x = "SDP (pollution)",
    y = "GDP (economic development)",
    title ="Regression model (1) : GDP ~ SDG"
  ) +
  theme_minimal()
```

Our fitted line implies a quite straightforward relationship between GDP and gas emissions : the richer a country is, the more it will pollute.
However, this is not enough to answer our question : has pollution been necessary ?
In other terms, we do not have here yet our environmental Kuznets curve, since we captured a single mean over time for each country.
It allows us however to get a first global impression on the relationship GDP has with SDGs.
It consequently seems that the Kuznets curve is not a reality on a global scale.

#### Explanatory power and Fisher test

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
anova_model <- anova(model) 
print(anova_model)
```

The low p-value indicates our model has explanatory power.

##### Chi-2

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
chi2_test <- chisq.test(Merged_data)

chi2_statistic <- chi2_test$statistic 
p_value <- chi2_test$p.value 
print(chi2_statistic) 
print(p_value)
```

##### Chi-2

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
chi2_test <- chisq.test(Merged_data)

chi2_statistic <- chi2_test$statistic 
p_value <- chi2_test$p.value 
print(chi2_statistic) 
print(p_value)
```

### Considering GDP as a function of SDGs and deaths due to air pollution (model 2)

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model2 <- lm(Mean_GDP ~ deaths_due_to_pollution * SDGs, data = Merged_data)
summary(model2)
```

#### Analysis

##### Interpretation of Coefficients :

The intercept has a value of 16,780, meaning that when both deaths due to pollution and SDGs are zero, the predicted GDP is 16,780.
However, since these values cannot realistically be zero, the intercept has limited real-world interpretability.

The slope coefficient for deaths due to pollution is -0.02846, indicating that for every 1-unit increase in pollution-related deaths, GDP decreases by 0.02846.
This suggests a negative relationship between pollution-related mortality and economic performance, which is quite logical, as the death of one person leads to the loss of a potential workforce.

The slope coefficient for SDGs is -7.213, meaning that for every 1-unit increase in the SDG score, GDP decreases by 7.213.
This suggests that, within this model, higher SDG performance is associated with lower GDP levels.
This means that when a country is more respectful of the sustainable development goals, its GDP decrease.
The interpretation of this is that pollution is leading to more wealth.

The interaction term between deaths due to pollution and SDGs has a coefficient of 0.00001712, suggesting that as SDG scores increase, the negative impact of pollution-related deaths on GDP is slightly mitigated.
However, the effect size is very small.

##### Significance of Coefficients :

The t-values for all coefficients are large in magnitude, and the p-values are extremely low (\<2e-16), indicating that the relationships between GDP, pollution-related deaths, and SDGs are statistically significant and unlikely to be due to random chance.

##### Model Fit :

While the relationships between GDP, pollution-related deaths, and SDGs are statistically significant, the low R-squared value (0.05905) suggests that these variables explain only 5.9% of the variation in GDP.
This indicates that GDP is influenced by many other factors not included in this model.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

fitted_values <- fitted(model2)
residuals <- residuals(model2)

library(interactions)
interact_plot(model2, pred = deaths_due_to_pollution, modx = SDGs, plot.points = TRUE, interval = TRUE) + labs( title = "Interaction Effect of Pollution and SDGs on GDP", x = "Deaths Due to Pollution", y = "Mean GDP" ) + theme_minimal() + theme( plot.title = element_text(size = 14, face = "bold", hjust = 0.5), axis.title = element_text(size = 12, face = "bold"), legend.title = element_text(size = 10, face = "bold"), legend.position = "right" )
```

The different fitted lines in this graphic offer various interpretations of the relationship between GDP, deaths due to air pollution, and the SDGs.
The trends of the curves are similar but differ in the steepness of their slopes.
When the SDGs decrease by one unit, the relationship between mean GDP and deaths due to pollution is more negative and stronger compared to when the SDGs are at their mean or when they improve by one unit.

This means that when SDGs are less respected, implying that a given country pollutes more, the number of deaths due to air pollution increases more sharply as GDP declines.
Poorer countries struggle more to combat pollution and climate change issues because doing so comes at a cost that is often inaccessible given their GDP.

### Improving the modelization of pollution - GDP as a function of gas emissions and deaths due to pollution (model3)

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model3 <- lm(Mean_GDP ~ deaths_due_to_pollution * SDGs, data = Merged_data)
summary(model3)
```

#### Analysis

### Inverting causality : air pollution as a function of GDP and deaths due to pollution (model 4)

##### Interpretation of Coefficients

The intercept has an estimated value of 556.3, meaning that when both deaths due to pollution and GDP are zero, the predicted SDG score is 556.3.
However, as these variables cannot realistically be zero, this intercept does not have a direct real-world interpretation.

The coefficient for the deaths due to pollution is 0.001295, indicating that for every 1-unit increase in pollution-related deaths, the SDG score increases by 0.001295.
This suggests a positive relationship between pollution-related mortality and SDG scores, which could reflect the presence of interventions or responses tied to public health measures that may impact SDG outcomes.

The coefficient for the mean of the GDP is -0.007771, meaning that for every 1-unit increase in GDP, the SDG score decreases by 0.007771.
This suggests a negative relationship between GDP and SDG performance, possibly reflecting the prioritization of economic growth over certain SDG objectives, particularly those related to sustainability or inequality.

The interaction term between deaths due to pollution and Mean GDP has a coefficient of -1.799e-07, suggesting that as GDP increases, the positive relationship between deaths due to pollution and SDGs slightly decreases.
This indicates a small mitigating effect of GDP on the relationship between pollution-related deaths and SDG performance.

##### Significance of Coefficients

All coefficients are statistically significant, as indicated by their extremely low p-values (\< 2e-16).
This means that the relationships between SDGs, deaths due to pollution, and GDP are unlikely to be due to random chance, and all terms are crucial in explaining SDG scores.

##### Model Fit

The R-squared value is 0.05911, indicating that only 5.91% of the variation in SDGs is explained by deaths due to pollution, GDP, and their interaction.
This suggests that the model does not capture most of the variation in SDG scores, and other factors not included in the model likely play a more significant role in determining SDG performance.

The F-statistic is 1.086e+05, with a p-value of \<2.2e-16, indicating that the overall model is statistically significant.
However, the relatively low R-squared suggests that while the model is significant, it may not explain much of the variation in SDGs.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(ggplot2)

fitted_values <- fitted(model3)
residuals <- residuals(model3)

library (interactions)

new_data <- expand.grid (deaths_due_to_pollution = seq(min(Merged_data$deaths_due_to_pollution), max(Merged_data$deaths_due_to_pollution), length.out = 100), Mean_GDP = mean(Merged_data$Mean_GDP)) 
new_data$SDGs <- mean(Merged_data$SDGs)
new_data$SDGs <- predict(model3, newdata = new_data) 

ggplot(new_data, aes(x = deaths_due_to_pollution, y = SDGs, color = factor(Mean_GDP))) + geom_point() + geom_line(data = new_data, aes(y = SDGs), linetype = "solid") + labs(title = "Interaction Effect of Pollution and GDP on SDGs", x = "Deaths Due to Pollution", y = "SDGs") + theme_minimal() + theme(plot.title = element_text(size = 14, face = "bold", hjust = 0.5), axis.title = element_text(size = 12, face = "bold"), legend.title = element_text(size = 10, face = "bold"), legend.position = "right") # Display the plot
```

For a mean GDP of 13426.43, we have a negative relation between SDGs and deaths due to pollution.
The more an imaginary country with this mean GDP disrespect the SDGs, the more it will have a high number of deaths due to pollution.
On the contrary, a theorical country respecting more the SDGs will see its number of deaths due to pollution decreasing.

#### Checking for multicolinearity

To check for multicolinearity, we compute the Variance Inflation Factor values of the model.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(car)
vif_values <- vif(model3) 
print(vif_values)
```

We obtain Variance Inflation Factors lower than five, and can hence conclude on low multicolinearity between our two explanatory variables.

#### Explanatory power and Fisher test

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
adj_r_squared <- summary_model3$adj.r.squared 
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
anova_model3 <- anova(model3) 
print(anova_model3)
```

##### Chi-2

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
chi2_statistic <- chi2_test$statistic 
p_value <- chi2_test$p.value 
print(chi2_statistic) print(p_value)
```

#### Analysis

## Study case : South Korea

We have seen that overall, it seems more pollution generates more GDP per capita.
We will now try to analyse this over time, using data from South Korea.
We made this choice considering its major GDP growth for the last decade, making it a particularly interesting case to study.

### Quit data load and description

We will keep working with the World Bank data, loading directly here GDP for Korea for all years available, and simultaneously with air pollution.

```{r}
library(WDI)

gdp_korea <- gdp_data <- WDI(indicator = "NY.GDP.MKTP.CD", country = "KOR", start = 2000, end = 2024)

pollution_korea <- WDI(indicator = "EN.ATM.PM25.MC.M3", country = "KOR", start = 2000, end = 2024)

head(gdp_korea)
head(pollution_korea)
```

We then merge those two datasets together in order to get values per year for both GDP and pollution.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
merged_korea <- merge(gdp_korea, pollution_korea, by = "year")
merged_korea
```

In order to get more clarity from the World Bank classification codes, we rename columns.
EN.ATM.PM25.MC.M3 and NY.GDP.MKTP.CD become respectively Pollution and GDP.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
merged_korea <- merged_korea %>% 
  rename( GDP = NY.GDP.MKTP.CD, Pollution = EN.ATM.PM25.MC.M3 )
```

### Testing for a Korean environmental Kuznets curve

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model_korea <- lm(Pollution ~ GDP, data = merged_korea) 
summary(model_korea)
```

#### Analysis

##### Interpretation of coefficients

The intercept has an estimated value of 22.92, meaning that when GDP is zero, the predicted SDG score is 22.92.
However, this intercept lacks direct real-world meaning, as GDP cannot realistically be zero.
The coefficient for GDP is 1.853e-12, indicating that for every 1-unit increase in GDP, the SDG score increases by 1.853e-12.
While this suggests a positive relationship between GDP and SDG scores, the relationship is quite small, reflecting a minimal effect of GDP on the SDG score.

##### Significance of Coefficients

The intercept is statistically significant with a p-value of 2.84e-14, which is well below the threshold of 0.001, indicating a strong relationship between the intercept and SDG scores.
The coefficient for GDP is marginally significant, with a p-value of 0.0608.
Although it is just above the common significance level of 0.05, the coefficient suggests a weak but possible relationship between GDP and SDG scores.

##### Model fit

The R-squared value is 0.173, meaning that only 17.3% of the variation in SDGs is explained by GDP.
This indicates that the model does not capture most of the variation in SDG scores, and other factors not included in the model may be more significant in determining SDG performance.
The Adjusted R-squared value is 0.1295, which adjusts for the number of predictors and reflects a modest fit of the model, suggesting that the model's explanatory power is limited.
The F-statistic is 3.974 with a p-value of 0.06076.
While the model as a whole is close to being statistically significant, it is not at the conventional threshold (p-value \< 0.05), suggesting that the relationship between GDP and SDG performance may not be robust enough to draw strong conclusions from this model.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}

ggplot(merged_korea, aes(x = GDP, y = Pollution)) + 
  geom_point(color = "blue") + geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Linear Regression of GDP vs. Pollution in South Korea (model 6)", x = "GDP (Current US$)", y = "Pollution (PM2.5)") + 
  theme_minimal()
```

Here, it seems the Kuznets curve does not verify.
As Korea experiences higher growth per capita, pollution gets worse.
We do not yet observe pollution lowering, as it is in theory what we would have expected from the Kuznets environmental curve.

## Study case : Finland

### Quick data load and description

The process is exactly the same as the one we used for Korea.

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
library(WDI)

gdp_finland <- WDI(indicator = "NY.GDP.MKTP.CD", country = "FIN", start = 2000, end = 2024)

pollution_finland <- WDI(indicator = "EN.ATM.PM25.MC.M3", country = "FIN", start = 2000, end = 2024)

head(gdp_finland)
head(pollution_finland)

merged_finland <- merge(gdp_finland, pollution_finland, by = "year")

merged_finland <- merged_finland %>% 
  rename( GDP = NY.GDP.MKTP.CD, Pollution = EN.ATM.PM25.MC.M3 )
```

### Testing for a Finland environmental Kuznets curve

```{r, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
model_korea <- lm(Pollution ~ GDP, data = merged_finland)

summary(model_korea)
```

#### Analysis

##### Interpretation of coefficients

The intercept has an estimated value of 9.879, meaning that when GDP is zero, the predicted pollution score is 9.879.
The coefficient for GDP is -1.400e-11, indicating that for each 1-unit increase in GDP, the pollution score decreases by 1.400e-11.
This suggests a negative relationship between GDP and pollution in Finland, which contrasts with the positive relationship seen in South Korea.
This difference may reflect distinct economic and environmental contexts between the two countries, as Finland is a developed country for a longer time than South Korea.
In this case, it is following the Kuznets curve, as now that it became rich, and for a long time, its pollution decrease.
We should be on the decreasing slope of the Kuznets curve.

##### Significance of coefficients

The intercept is statistically significant with a p-value of 2.97e-10, indicating a strong relationship between the intercept and the pollution score.
The coefficient for GDP is also statistically significant with a p-value of 0.000802, showing that GDP has a significant negative impact on pollution in Finland.
This contrasts with South Korea, where the relationship with GDP was marginal (p-value of 0.0608).

##### Model fit

The R-squared value is 0.4547, meaning that 45.47% of the variation in pollution is explained by GDP in Finland.
This is much higher than the R-squared value for South Korea (0.173), suggesting that GDP plays a more significant role in explaining pollution variation in Finland.
The F-statistic is 15.84 with a p-value of 0.0008016, indicating that the overall model is statistically significant.
This result is stronger than that for South Korea (p-value of 0.06076), suggesting that the model for Finland is more robust.

```{r,echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
ggplot(merged_finland, aes(x = GDP, y = Pollution)) + 
  geom_point(color = "blue") + geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Linear Regression of GDP vs. Pollution in Finland (model 7)", x = "GDP (Current US$)", y = "Pollution (PM2.5)") + 
  theme_minimal()
```

This graphic confirms what we saw before, Finland is on the decreasing slope of the Kuznets curve, as its GDP in increasing, its gas emissions are decreasing.

## Conclusion

Countries show varied perspectives on GDP, pollution, its limitations, and its impacts.
When examining specific countries at different stages of development, such as Finland and South Korea, we can observe the Kuznets curve in action.
However, an important question arises: do countries on the downward slope of the Kuznets curve truly have lower pollution levels, or are they simply outsourcing their pollution to less developed countries?
This question aligns with the work of Esther Duflo, a Nobel Prize-winning economist, who argued in a *Les Échos* article that wealthier countries should compensate poorer nations for their contribution to pollution and help them adapt to climate change, as these populations are often the most vulnerable.
However, due to the challenges of managing large datasets, we were unable to analyze this issue comprehensively and over a long period.

## References

1.  Stern, D. I.
    (2004).
    *The Rise and Fall of the Environmental Kuznets Curve*.
    *World Development*, 32(8), 1419--1439.
    https://doi.org/10.1016/j.worlddev.2004.03.004

2.  Dinda, S.
    (2004).
    *Environmental Kuznets Curve Hypothesis: A Survey*.
    *Ecological Economics*, 49(4), 431--455.
    https://doi.org/10.1016/j.ecolecon.2004.02.011

3.  Stern, D. I.
    (2017).
    *The Environmental Kuznets Curve After 25 Years*.
    *Journal of Bioeconomics*, 19, 7--28.
    https://doi.org/10.1007/s10818-017-9243-1

4.  Özcan, B., & Öztürk, I.
    (2019).
    *Environmental Kuznets Curve (EKC): A Manual*.
    Academic Press.

5.  Raworth, K.
    (2017).
    *Doughnut Economics: Seven Ways to Think Like a 21st-Century Economist*.
    Chelsea Green Publishing.

6.  Salin, M.
    (2020).
    La « courbe de Kuznets environnementale » et le « découplage » : deux concepts du débat sur la croissance verte.
    *Regards croisés sur l'économie*, 26(1), 145--152.
    https://doi.org/10.3917/rce.026.0145

7.  Martínez-Alier, J.
    (2002).
    *The Environmentalism of the Poor: A Study of Ecological Conflicts and Valuation*.
    Northampton, MA: Edward Elgar Publishing.

8.  Laurent, É.
    (2009).
    *Écologie et inégalités*.
    *Revue de l'OFCE*, 109, 33--57.

9.  Destek, M. A., Ulucak, R., & Dogan, E.
    (2018).
    *Analyzing the Environmental Kuznets Curve for the EU Countries: The Role of Ecological Footprint*.
    *Environmental Science and Pollution Research*, 25(29), 29387--29396.
10. Duflo, Esther. (2024). *Esther Duflo, Prix Nobel d’économie: Il faut offrir une compensation aux citoyens les plus pauvres du monde et les aider à s’adapter au changement climatique*. Tribune publiée dans le journal français *Le Monde*.
